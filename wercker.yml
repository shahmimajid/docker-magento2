box: debian:stable-slim
## Build Definition
build:
  # Step that will be executed on build
  steps:
    - install-packages:
        packages: git 
    # Test the project
    - script:
        name: Git clone
        code : git clone https://github.com/shahmimajid/docker-magento2.git 
    - script:
        name: Permission Fix
        code : chmod u+x ~/docker-magento2/deploy.sh

deploy-to-docker:
    box: debian:stable-slim
    steps:
    # Installs openssh client and other dependencies.
    - install-packages:
        packages: openssh-client openssh-server git 
    # Adds docker server to the list of known hosts.
    - add-to-known_hosts:
        hostname: $devserver
        local: true
    # Adds SSH key created by Wercker
    - add-ssh-key:
        keyname: devserver
    # Deployment
    - script:
        name: Deploy to server
        code: ssh $user@$devserver git clone https://github.com/shahmimajid/docker-magento2 && cd /home/$user/docker-magento2 && sh install.sh