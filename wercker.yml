box: debian:stable-slim
## Build Definition
build:
  # Step that will be executed on build
  steps:
    # Test the project
    #Docker Build - Magento2    

deploy-to-docker:
    box: debian
    steps:
    # Installs openssh client and other dependencies.
    - install-packages:
        packages: openssh-client openssh-server git 
    # Adds docker server to the list of known hosts.
    - add-to-known_hosts:
        hostname: docker.shahmimajid.com
        local: true
    # Adds SSH key created by Wercker
    - add-ssh-key:
        keyname: devserver
    # Git Clone
    - script:
        name: Git Clone Docker-Magento2
        code: |
          ssh $user@docker.shahmimajid.com
          if [ ! -d "$FOLDER" ] ; then
             git clone "$docker_magento2_url" "$FOLDER"
          else
             cd "$FOLDER"
             git pull "$docker_magento2_url"
          fi
    - script:
        name: Set URL for Development
        code: ssh $user@docker.shahmimajid.com sed -i "/s/local.magento/$DEV_URL/g" /home/$user/docker-magento2/env
    - script:
        name: Set URL for Development
        code: 

